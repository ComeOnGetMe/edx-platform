---
metadata:
    display_name: UCSD Problem with Adaptive Hint and Variables
    markdown: !!null
data: |
    <problem>
      <text>

        <script type="loncapa/python">
    # variable names and values
    # if multiple variables, the number of values to test should be the same
    variable_values = {'n':[1,2,3], 'k':[4,5,6]}

    # value index used to extract hint
    index_for_hint = 2
          
    # random variables
    r = random.randrange(3,6,1)
          
    # solution string
    solution = "26^n+k+{0}".format(r)
    solutions = [solution]

    # hint id
    hint_id = "cse103fall2016week1problem1part1"
      </script>
        
      <script type="text/javascript">
        //fill in number of hint
          var hint_number = 1;

        //fill in hint input box id
          var hintId = ["input_57ccdc78397649aca59b419c95573254_2_1"];

        //fill in problem input box id
          var proId = ["input_0463a3ce78dd46429e9e2fcf681616d9_2_1"];

        //fill in hint text id. Need to match the hint_id from above
          var hintTextId = ["cse103fall2016week1problem1part1"];
      </script>
      
      <p>How many strings of length \(n\) consisting of lower case English letters are there?</p>
      <customresponse cfn="check" expect="\[$solution\]">
        <textline/>
        <hintgroup hintfn="hint_fn"/>
      </customresponse>






        <script type="loncapa/python">
    from hint import evaluate
    from hint import cluster_functions
    from hint import universal_hints as u_hint
    from hint import conditional_hints as c_hint
          
    # grader of the problem
    def check(expect, ans):
      return evaluate.evaluate_w_variables(expect, ans, variable_values)
          
    def hint_fn(answer_ids, student_answers, new_cmap, old_cmap):
      aid = answer_ids[0]
      ans = str(student_answers[aid])
      i = int(aid[-3])-2

      if ans == "":
        return

      key = new_cmap.keys()[0]
      if new_cmap[key]['correctness'] == "correct":
        return

      param = cluster_functions.make_params_w_variables(solutions[i], ans, variable_values, index_for_hint)
      if param == {}:
        return
      hint = u_hint.universal_hint_w_variables(param, variable_values.keys())
      if hint:
        hint = "&lt;font color='blue'&gt;Hint: {0}&lt;/font&gt;".format(hint)
      else:
        hint_text, hint_answer = c_hint.conditional_hint_w_variables(param, variable_values.keys())
        if not hint_text:
          return
        hint_answer_id = hint_id[i] + "answer"
        hint = "&lt;button onclick='show_hint({0})'&gt;Show hint&lt;/button&gt;".format(i)
        hint += "&lt;p id='{0}' style='display:none'&gt; {1} &lt;/p&gt;".format(hint_id[i], hint_text)
        hint += "&lt;p id='{0}' style='display:none'&gt; {1} &lt;/p&gt;".format(hint_answer_id, hint_answer)
      new_cmap.set_hint_and_mode(aid,hint,'always')
      </script>
        
        
        <script type="text/javascript">
        function hide_hint() {
            var index = arguments[0];
            var hintInputId = hintIds[index];
            var proId = proIds[index];
            var hintId = hintInputId.replace('input', 'problem');
            hintId = hintId.slice(0, -4);
            var hintEle = document.getElementById(hintId)
            if (!hintEle) {
              return;
            }
            var hintInputEle = document.getElementById(hintInputId)
            if (!hintInputEle) {
              return;
            }
            var hintStatusId = hintInputId.replace('input', 'status');
            var hintStatusEle = document.getElementById(hintStatusId);
            if (!hintStatusEle) {
              return;
            }
            hintEle.style.display = "none";
            hintInputEle.value = "";
            hintStatusEle.className = "incorrect";
        }
                 
        function show_hint() {
            var index = arguments[0];
            var hintInputId = hintIds[index];
            var hintId = hintInputId.replace('input', 'problem');
            hintId = hintId.slice(0, -4);
            var hintTextId = hintTextIds[index];
            var hintAnswerId = hintTextId + "answer";
            var hintStatusId = hintInputId.replace('input', 'status');
            var proInputId = proIds[index];
            var proId = proInputId.replace('input', 'status');
            //var prohintId = proInputId.replace('input', 'inputtype');
            
            var hintInputEle = document.getElementById(hintInputId);
            if (!hintInputEle) {
                 return;
            }
            var hintEle = document.getElementById(hintId);
            if (!hintEle) {
                 return;
            }
            var hintAnswerEle = document.getElementById(hintAnswerId);
            if (!hintAnswerEle) {
                 return;
            }
            var hintStatusEle = document.getElementById(hintStatusId);
            if (!hintInputEle) {
                 return;
            }
            var proInputBox = document.getElementById(proInputId);
            if (!proInputBox) {
                 return;
            }
            var proEle = document.getElementById(proId);
            if (!proEle) {
                 return;
            }
                 
            if (proEle.classList.contains("incorrect")) {
              if (proInputBox.value != "") {
                if (document.getElementById(hintTextId)) {
                  var hintText = document.getElementById(hintTextId).innerHTML;
                  document.getElementById(hintId).style.display = "";
                  document.getElementById(hintId).getElementsByTagName('p')[0].innerHTML = hintText;
                  var inputValue = document.getElementById(hintInputId).value;
                  var answerValue = document.getElementById(hintAnswerId).innerHTML;
                  answerValue = answerValue.substring(1);
                  answerValue = answerValue.slice(0,-1);
                  if (inputValue == answerValue) {
                    document.getElementById(hintStatusId).className = "correct";
                  } else {
                    document.getElementById(hintStatusId).className = "incorrect";
                  }
                }
              }
            }
        }
          
        for (var i=0; i != hint_number; i++) {
            hide_hint(i);
        }
        </script>

      </text>
    </problem>
